<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="JingFengJi">
<meta property="og:url" content="https://jingfengji.github.io/page/4/index.html">
<meta property="og:site_name" content="JingFengJi">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JingFengJi">






  <link rel="canonical" href="https://jingfengji.github.io/page/4/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>JingFengJi</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JingFengJi</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/08/09/Unity之UGUI脚本自动生成/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/08/09/Unity之UGUI脚本自动生成/" class="post-title-link" itemprop="url">Unity之UGUI脚本自动生成</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-08-09 00:33:43" itemprop="dateCreated datePublished" datetime="2017-08-09T00:33:43+08:00">2017-08-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:31" itemprop="dateModified" datetime="2019-03-11T22:05:31+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/08/09/Unity之UGUI脚本自动生成/" class="leancloud_visitors" data-flag-title="Unity之UGUI脚本自动生成">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>在做UI开发工作中，往往会有很多重复工作，比如用FindChild找可交互的ui呀，比如给这些ui加Listener等，那么这里提供一种思路，通过给UI中需要加交互事件的ui物体加上标记脚本，然后就可以根据这些标记得出相对于UIRoot的路径，得到路径就可以通过FindChild得到交互UI物体，然后给他们加上事件监听即可。</p>
<p>先定义一个枚举</p>
<pre><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public enum UIType 
{
    UIRoot,
    Transform,
    Image,
    RawImage,
    Button,
    Toggle,
    Slider,
    Scrollbar,
    Dropdown,
    InputField,
    ScrollRect,
}
</code></pre><p>然后上一个效果图来给UI物体加标记</p>
<p><img src="https://img-blog.csdn.net/20170809002217766?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>从图中可以看出，加完标记之后，生成代码。<br>先看示例的UIDialog<br><img src="https://img-blog.csdn.net/20170809002336955?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>其中图中两一个Image，一个InputFiel，一个Button，一个Toggle<br>生成的代码如下：</p>
<pre><code>using UnityEngine;
using UnityEngine.UI;
using System;

public class TestDialog : MonoBehaviour
{
    private Image m_Image = null;
    private InputField m_UserNameInputField = null;
    private Button m_CloseButton = null;
    private Toggle m_SexToggle = null;

    void Awake()
    {
        m_Image = transform.FindChild(&quot;Image&quot;).GetComponent&lt;Image&gt;();
        m_UserNameInputField = transform.FindChild(&quot;Image/UserNameInputField&quot;).GetComponent&lt;InputField&gt;();
        m_CloseButton = transform.FindChild(&quot;CloseButton&quot;).GetComponent&lt;Button&gt;();
        m_SexToggle = transform.FindChild(&quot;SexToggle&quot;).GetComponent&lt;Toggle&gt;();
    }

    void Start()
    {
        InitUIEvent();
    }

    private void InitUIEvent()
    {
        m_UserNameInputField.onEndEdit.AddListener(OnUserNameInputFieldEndEdit);
        m_CloseButton.onClick.AddListener(OnCloseButtonClick);
        m_SexToggle.onValueChanged.AddListener(OnSexToggleValueChanged);
    }

    private void OnUserNameInputFieldEndEdit(string arg0)
    {
        throw new NotImplementedException();
    }

    private void OnCloseButtonClick()
    {
        throw new NotImplementedException();
    }

    private void OnSexToggleValueChanged(bool arg0)
    {
        throw new NotImplementedException();
    }
}
</code></pre><p>生成代码的逻辑比较长，就不放出来了，原理就是按照规范拼StringBuilder，包括变量名前缀，函数名规范等，以及插入等长度的空格代替tab、还有换行使得代码对其等等。</p>
<h4 id="这个只是提供一种思路，Demo以及源码会放在下面，大家有兴趣可以参考一下，转载请注明原文地址。"><a href="#这个只是提供一种思路，Demo以及源码会放在下面，大家有兴趣可以参考一下，转载请注明原文地址。" class="headerlink" title="这个只是提供一种思路，Demo以及源码会放在下面，大家有兴趣可以参考一下，转载请注明原文地址。"></a><strong>这个只是提供一种思路，Demo以及源码会放在下面，大家有兴趣可以参考一下，转载请注明原文地址。</strong></h4><p>Demo源码下载地址：<br>链接： <a href="http://pan.baidu.com/s/1i4YbIML" target="_blank" rel="noopener"> http://pan.baidu.com/s/1i4YbIML </a><br>密码：uyg9</p>
<p>下载链接如有失效，请即时联系<br>以上知识分享，如有错误，欢迎指出，共同学习，共同进步</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/08/06/Unity之简易定时器Timer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/08/06/Unity之简易定时器Timer/" class="post-title-link" itemprop="url">Unity之简易定时器Timer</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-08-06 19:08:58" itemprop="dateCreated datePublished" datetime="2017-08-06T19:08:58+08:00">2017-08-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:06" itemprop="dateModified" datetime="2019-03-11T22:05:06+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/08/06/Unity之简易定时器Timer/" class="leancloud_visitors" data-flag-title="Unity之简易定时器Timer">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>有时候我们会有这样的需求：几秒或者几帧之后做什么事，也就是一个定时器。这里我利用Time.realtimeSinceStartup实现了一个简单的秒钟定时器，当然还可以利用Time.frameCount实现一个帧计时器</p>
<p>上代码：</p>
<pre><code>using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Timer 
{

    private Timer()
    {
        m_timerTask = new List&lt;TimerTask&gt;();
    }

    private static Timer m_instance;

    public static Timer Instance
    {
        get
        {
            if (m_instance == null)
            {
                m_instance = new Timer();
            }
            return m_instance;
        }
    }

    public delegate void OnTimeStart();

    private List&lt;TimerTask&gt; m_timerTask = null;

    public class TimerTask
    {
        //public int Id;
        public float RealTime;
        public float Time;
        //public bool IsLoop;
        //public int LoopCount;
        public OnTimeStart CallBack;
    }

    public void UpdateTimer()
    {
        for (int i = 0; i &lt; m_timerTask.Count; i++)
        {
            TimerTask t = m_timerTask[i];
            if (t == null)
            {
                continue;
            }
            if (t.RealTime &lt; Time.realtimeSinceStartup)
            {
                if (null != t.CallBack)
                {
                    t.CallBack();
                    m_timerTask.Remove(t);
                }
            }
        }
    }

    public void AddTimerTask(float time, OnTimeStart callback)
    {
        if (null == callback)
        {
            return;
        }
        TimerTask t = new TimerTask();
        t.Time = time;
        t.RealTime = Time.realtimeSinceStartup + time;
        t.CallBack = callback;
        m_timerTask.Add(t);
    }
}
</code></pre><p>上面的代码省略了是否循环、循环次数以及帧计时器，思路类似。<br>最后附上测试Demo下载地址：<br>链接： <a href="http://pan.baidu.com/s/1bp5xRSr" target="_blank" rel="noopener"> http://pan.baidu.com/s/1bp5xRSr </a><br>密码：y35i</p>
<p>下载链接如有失效，请即时联系<br>以上知识分享，如有错误，欢迎指出，共同学习，共同进步</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/08/06/Unity之拓展Button：支持双击与长按/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/08/06/Unity之拓展Button：支持双击与长按/" class="post-title-link" itemprop="url">Unity之拓展Button：支持双击与长按</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-08-06 18:32:52" itemprop="dateCreated datePublished" datetime="2017-08-06T18:32:52+08:00">2017-08-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:16" itemprop="dateModified" datetime="2019-03-11T22:05:16+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/08/06/Unity之拓展Button：支持双击与长按/" class="leancloud_visitors" data-flag-title="Unity之拓展Button：支持双击与长按">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>双击直接利用的eventData.clickCount实现，而长按则是在PointerDown的时候记录时间，然后在Update里判断时间即可，由于代码比较简单，直接上源码。</p>
<pre><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.EventSystems;
using UnityEngine.UI;

public class UIButton : Button 
{
    protected UIButton()
    {
        m_onDoubleClick = new ButtonClickedEvent();
        m_onLongPress = new ButtonClickedEvent();
    }

    private ButtonClickedEvent m_onLongPress;
    public ButtonClickedEvent OnLongPress
    {
        get { return m_onLongPress; }
        set { m_onLongPress = value; }
    }

    private ButtonClickedEvent m_onDoubleClick;
    public ButtonClickedEvent OnDoubleClick
    {
        get { return m_onDoubleClick; }
        set { m_onDoubleClick = value; }
    }

    private bool m_isStartPress = false;

    private float m_curPointDownTime = 0f;

    private float m_longPressTime = 1f;

    private bool m_longPressTrigger = false;

    void Update () 
    {
        if (m_isStartPress &amp;&amp; !m_longPressTrigger)
        {
            if (Time.time &gt; m_curPointDownTime + m_longPressTime)
            {
                m_longPressTrigger = true;
                m_isStartPress = false;
                if (m_onLongPress != null)
                {
                    m_onLongPress.Invoke();
                }
            }
        }
    }

    public override void OnPointerDown(PointerEventData eventData)
    {
        base.OnPointerDown(eventData);
        m_curPointDownTime = Time.time;
        m_isStartPress = true;
        m_longPressTrigger = false;
    }

    public override void OnPointerUp(PointerEventData eventData)
    {
        base.OnPointerUp(eventData);
        m_isStartPress = false;
        m_longPressTrigger = false;
    }

    public override void OnPointerExit(PointerEventData eventData)
    {
        base.OnPointerExit(eventData);
        m_isStartPress = false;
        m_longPressTrigger = false;
    }

    public override void OnPointerClick(PointerEventData eventData)
    {
        //base.OnPointerClick(eventData);
        if (!m_longPressTrigger)
        {
            if (eventData.clickCount == 1)
            {
                onClick.Invoke();
            }
            else if (eventData.clickCount == 2)
            {
                if (m_onDoubleClick != null)
                {
                    m_onDoubleClick.Invoke();
                }
            }
        }
    }
}
</code></pre><p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/07/16/Unity之ScrollRect滑动居中/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/07/16/Unity之ScrollRect滑动居中/" class="post-title-link" itemprop="url">Unity之ScrollRect滑动居中</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-16 19:30:15" itemprop="dateCreated datePublished" datetime="2017-07-16T19:30:15+08:00">2017-07-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:01:11" itemprop="dateModified" datetime="2019-03-11T22:01:11+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/07/16/Unity之ScrollRect滑动居中/" class="leancloud_visitors" data-flag-title="Unity之ScrollRect滑动居中">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>先上效果图<br><img src="https://img-blog.csdn.net/20170716183336257?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>这里同时支持水平方向和垂直方向，同时ScrollRect支持使用GridLayoutGroup、HorizontalLayoutGroup、VerticalLayoutGroup三种LayoutGroup，不过水平方向的ScrollRect不支持VerticalLayoutGroup，垂直方向的ScrollRect不支持HorizontalLayoutGroup，当然也不存在这两种情况。</p>
<p>由于这里是通过对ScrollRect的content的localPosition做了插值移动，因此ScrollRect的中心点设置必须跟我这保持一致。</p>
<p>下面直接上代码：</p>
<pre><code>using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.EventSystems;
using UnityEngine.UI;

public enum ScrollDir
{
    Horizontal,
    Vertical
}

public class ScrollRectCenter : MonoBehaviour , IEndDragHandler,IDragHandler,IBeginDragHandler
{
    public ScrollDir Dir = ScrollDir.Horizontal;

    /// &lt;summary&gt;
    /// 是否正在居中
    /// &lt;/summary&gt;
    private bool _isCentering = false;

    /// &lt;summary&gt;
    /// 居中过程移动速度
    /// &lt;/summary&gt;
    public float MoveToCenterSpeed = 10f;

    private ScrollRect _scrollView;

    private Transform _content;

    private List&lt;float&gt; _childrenPos = new List&lt;float&gt;();
    private float _targetPos;

    /// &lt;summary&gt;
    /// 当前中心child索引
    /// &lt;/summary&gt;
    private int _curCenterChildIndex = -1;

    /// &lt;summary&gt;
    /// 当前中心ChildItem
    /// &lt;/summary&gt;
    public GameObject CurCenterChildItem
    {
        get
        {
            GameObject centerChild = null;
            if (_content != null &amp;&amp; _curCenterChildIndex &gt;= 0 &amp;&amp; _curCenterChildIndex &lt; _content.childCount)
            {
                centerChild = _content.GetChild(_curCenterChildIndex).gameObject;
            }
            return centerChild;
        }
    }

    void Awake()
    {
        _scrollView = GetComponent&lt;ScrollRect&gt;();
        if (_scrollView == null)
        {
            Debug.LogError(&quot;ScrollRect is null&quot;);
            return;
        }
        _content = _scrollView.content;

        LayoutGroup layoutGroup = null;
        layoutGroup = _content.GetComponent&lt;LayoutGroup&gt;();

        if (layoutGroup == null)
        {
            Debug.LogError(&quot;LayoutGroup component is null&quot;);
        }
        _scrollView.movementType = ScrollRect.MovementType.Unrestricted;
        float spacing = 0f;
        //根据dir计算坐标，Horizontal：存x，Vertical：存y
        switch (Dir)
        {
            case ScrollDir.Horizontal:
                if (layoutGroup is HorizontalLayoutGroup)
                {
                    float childPosX = _scrollView.GetComponent&lt;RectTransform&gt;().rect.width * 0.5f - GetChildItemWidth(0) * 0.5f;
                    spacing = (layoutGroup as HorizontalLayoutGroup).spacing;
                    _childrenPos.Add(childPosX);
                    for (int i = 1; i &lt; _content.childCount; i++)
                    {
                        childPosX -= GetChildItemWidth(i) * 0.5f + GetChildItemWidth(i - 1) * 0.5f + spacing;
                        _childrenPos.Add(childPosX);
                    }
                }
                else if (layoutGroup is GridLayoutGroup)
                {
                    GridLayoutGroup grid = layoutGroup as GridLayoutGroup;
                    float childPosX = _scrollView.GetComponent&lt;RectTransform&gt;().rect.width * 0.5f - grid.cellSize.x * 0.5f;
                    _childrenPos.Add(childPosX);
                    for (int i = 0; i &lt; _content.childCount - 1; i++)
                    {
                        childPosX -= grid.cellSize.x + grid.spacing.x;
                        _childrenPos.Add(childPosX);
                    }
                }
                else
                {
                    Debug.LogError(&quot;Horizontal ScrollView is using VerticalLayoutGroup&quot;);
                }
                break;
            case ScrollDir.Vertical:
                if (layoutGroup is VerticalLayoutGroup)
                {
                    float childPosY = -_scrollView.GetComponent&lt;RectTransform&gt;().rect.height * 0.5f + GetChildItemHeight(0) * 0.5f;
                    spacing = (layoutGroup as VerticalLayoutGroup).spacing;
                    _childrenPos.Add(childPosY);
                    for (int i = 1; i &lt; _content.childCount; i++)
                    {
                        childPosY += GetChildItemHeight(i) * 0.5f + GetChildItemHeight(i - 1) * 0.5f + spacing;
                        _childrenPos.Add(childPosY);
                    }
                }
                else if (layoutGroup is GridLayoutGroup)
                {
                    GridLayoutGroup grid = layoutGroup as GridLayoutGroup;
                    float childPosY = -_scrollView.GetComponent&lt;RectTransform&gt;().rect.height * 0.5f + grid.cellSize.y * 0.5f;
                    _childrenPos.Add(childPosY);
                    for (int i = 1; i &lt; _content.childCount; i++)
                    {
                        childPosY += grid.cellSize.y + grid.spacing.y;
                        _childrenPos.Add(childPosY);
                    }
                }
                else
                {
                    Debug.LogError(&quot;Vertical ScrollView is using HorizontalLayoutGroup&quot;);
                }
                break;
        }
    }

    private float GetChildItemWidth(int index)
    {
        return (_content.GetChild(index) as RectTransform).sizeDelta.x;
    }

    private float GetChildItemHeight(int index)
    {
        return (_content.GetChild(index) as RectTransform).sizeDelta.y;
    }

    void Start () 
    {

    }

    void Update () 
    {
        if (_isCentering)
        {
            Vector3 v = _content.localPosition;
            switch (Dir)
            {
                case ScrollDir.Horizontal:
                    v.x = Mathf.Lerp(_content.localPosition.x, _targetPos, MoveToCenterSpeed * Time.deltaTime);
                    _content.localPosition = v;
                    if (Math.Abs(_content.localPosition.x - _targetPos) &lt; 0.01f)
                    {
                        _isCentering = false;
                    }
                    break;
                case ScrollDir.Vertical:
                    v.y = Mathf.Lerp(_content.localPosition.y, _targetPos, MoveToCenterSpeed * Time.deltaTime);
                    _content.localPosition = v;
                    if (Math.Abs(_content.localPosition.y - _targetPos) &lt; 0.01f)
                    {
                        _isCentering = false;
                    }
                    break;
            }


        }
    }

    public void OnDrag(PointerEventData eventData)
    {

    }

    public void OnEndDrag(PointerEventData eventData)
    {
        switch (Dir)
        {
            case ScrollDir.Horizontal:
                _targetPos = FindClosestChildPos(_content.localPosition.x, out _curCenterChildIndex);
                break;
            case ScrollDir.Vertical:
                _targetPos = FindClosestChildPos(_content.localPosition.y, out _curCenterChildIndex);
                break;
        }
        _isCentering = true;
    }

    public void OnBeginDrag(PointerEventData eventData)
    {
        _isCentering = false;
        _curCenterChildIndex = -1;
    }

    private float FindClosestChildPos(float currentPos, out int curCenterChildIndex)
    {
        float closest = 0;
        float distance = Mathf.Infinity;
        curCenterChildIndex = -1;
        for (int i = 0; i &lt; _childrenPos.Count; i++)
        {
            float p = _childrenPos[i];
            float d = Mathf.Abs(p - currentPos);
            if (d &lt; distance)
            {
                distance = d;
                closest = p;
                curCenterChildIndex = i;
            }
        }
        return closest;
    }
}
</code></pre><p>最后附上Demo下载链接：<br>链接： <a href="http://pan.baidu.com/s/1pLoJcjL" target="_blank" rel="noopener"> http://pan.baidu.com/s/1pLoJcjL </a><br>密码：js7g<br>链接如果失效，请及时评论，及时更新</p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/07/15/Unity之粘贴板操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/07/15/Unity之粘贴板操作/" class="post-title-link" itemprop="url">Unity之粘贴板操作</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-15 11:37:38" itemprop="dateCreated datePublished" datetime="2017-07-15T11:37:38+08:00">2017-07-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:20" itemprop="dateModified" datetime="2019-03-11T22:05:20+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/07/15/Unity之粘贴板操作/" class="leancloud_visitors" data-flag-title="Unity之粘贴板操作">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h1 id="Unity之粘贴板操作"><a href="#Unity之粘贴板操作" class="headerlink" title="Unity之粘贴板操作"></a>Unity之粘贴板操作</h1><p>Untiy提供GUIUtility.systemCopyBuffer进行对粘贴板缓存数据存储与获取</p>
<p>官方解释为访问系统的粘贴板，可set，可get</p>
<p>上图<br><img src="https://img-blog.csdn.net/20170715113619738?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>附上官方文档地址：<br><a href="https://docs.unity3d.com/2017.2/Documentation/ScriptReference/GUIUtility-systemCopyBuffer.html" target="_blank" rel="noopener"> https://docs.unity3d.com/2017.2/Documentation/ScriptReference/GUIUtility-systemCopyBuffer.html</a></p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/07/09/Unity之简易任务队列TaskQueue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/07/09/Unity之简易任务队列TaskQueue/" class="post-title-link" itemprop="url">Unity之简易任务队列TaskQueue</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-09 18:31:22" itemprop="dateCreated datePublished" datetime="2017-07-09T18:31:22+08:00">2017-07-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:08" itemprop="dateModified" datetime="2019-03-11T22:05:08+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/07/09/Unity之简易任务队列TaskQueue/" class="leancloud_visitors" data-flag-title="Unity之简易任务队列TaskQueue">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<h1 id="任务队列"><a href="#任务队列" class="headerlink" title="任务队列"></a>任务队列</h1><p>该功能包括两个类：Task任务类，TaskQueue任务队列类<br>其中TaskQueue负责：<br>1、开始任务<br>2、添加任务<br>3、清空任务<br>4、开始任务回调<br>5、完成队列中所有任务回调<br>6、下一个任务<br>7、当前任务进度<br>8、队列存储所有任务</p>
<p>其中Task类代码如下：</p>
<pre><code>using System;
using System.Collections;
using System.Collections.Generic;

public class Task 
{
    //任务名
    private string m_TaskName;
    public string TaskName
    {
        set
        {
            m_TaskName = value;
        }
        get
        {
            return m_TaskName;
        }
    }

    //任务具体内容，外部传入
    public Action Work;

    public Task(Action work, string taskName = &quot;defaultTaskName&quot;)
    {
        this.Work = work;
        this.m_TaskName = taskName;
    }
}
</code></pre><p>TaskQueue类代码如下：</p>
<pre><code>using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class TaskQueue 
{
    //构造函数
    public TaskQueue()
    {
        m_TaskQueue = new Queue&lt;Task&gt;();
        m_TasksNum = 0;
    }

    //1、添加任务
    public void AddTask(Task task)
    {
        m_TaskQueue.Enqueue(task);
    }

    public void AddTask(Action work)
    {
        Task task = new Task(work);
        m_TaskQueue.Enqueue(task);
    }

    //2、开始任务
    public void Start()
    {
        //获取任务队列的总任务数
        m_TasksNum = m_TaskQueue.Count;

        if (OnStart != null)
        {
            OnStart();
        }
        NextTask();
    }

    //3、清空任务
    public void Clear()
    {
        m_TaskQueue.Clear();
        m_TasksNum = 0;
    }

    //4、开始任务回调
    public Action OnStart = null;

    //5、完成所有任务回调
    public Action OnFinish = null;

    //6、下一个任务
    private void NextTask()
    {
        if (m_TaskQueue.Count &gt; 0)
        {
            Task task = m_TaskQueue.Dequeue();
            task.Work();
            NextTask();
        }
        else
        {
            if (OnFinish != null)
            {
                OnFinish();
            }
        }
    }

    //7、当前任务进度
    public float TaskProcess
    {
        get
        {
            return 1 - m_TaskQueue.Count * 1.0f / m_TasksNum;
        }
    }

    //8、任务队列总任务量
    private int m_TasksNum = 0;

    //9、任务队列
    private Queue&lt;Task&gt; m_TaskQueue;
}
</code></pre><p>然后写一个test脚本挂在相机上，测试前面的代码：</p>
<pre><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Test : MonoBehaviour 
{
    void Start () 
    {
        TaskQueue taskQueue = new TaskQueue();
        taskQueue.OnStart = () =&gt; { Debug.Log(&quot;OnStart&quot;); };
        taskQueue.OnFinish = () =&gt; { Debug.Log(&quot;OnFinish&quot;); };
        taskQueue.AddTask(Task1);
        taskQueue.AddTask(Task2);
        taskQueue.Start();
    }

    private void Task1()
    {
        Debug.Log(&quot;Task1&quot;);
    }

    private void Task2()
    {
        Debug.Log(&quot;Task2&quot;);
    }
}
</code></pre><p>执行结果如下图：<br><img src="https://img-blog.csdn.net/20170709182839383?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>该任务队列写的比较简单，后期会拓展，敬请期待。</p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/07/06/Unity之NetworkReachability描述网络可达性选项。/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/07/06/Unity之NetworkReachability描述网络可达性选项。/" class="post-title-link" itemprop="url">Unity之NetworkReachability描述网络可达性选项。</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-07-06 12:54:15" itemprop="dateCreated datePublished" datetime="2017-07-06T12:54:15+08:00">2017-07-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:27" itemprop="dateModified" datetime="2019-03-11T22:05:27+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/07/06/Unity之NetworkReachability描述网络可达性选项。/" class="leancloud_visitors" data-flag-title="Unity之NetworkReachability描述网络可达性选项。">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>Unity自带一个枚举NetworkReachability，用来描述网络可达性<br>NotReachable：网络无法访问<br>ReachableViaCarrierDataNetwork：通过运营商数据网络可以访问网络<br>ReachableViaLocalAreaNetwork：网络通过WIFI或电缆可达</p>
<p>附上Unity官方文档地址： <a href="https://docs.unity3d.com/ScriptReference/NetworkReachability.html" target="_blank" rel="noopener">https://docs.unity3d.com/ScriptReference/NetworkReachability.html</a></p>
<p>截图如下：<br><img src="https://img-blog.csdn.net/20170706125329699?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/04/26/Unity之使用IOS 3DTouch功能/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/26/Unity之使用IOS 3DTouch功能/" class="post-title-link" itemprop="url">Unity之使用IOS 3DTouch功能</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-26 16:53:21" itemprop="dateCreated datePublished" datetime="2017-04-26T16:53:21+08:00">2017-04-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:10" itemprop="dateModified" datetime="2019-03-11T22:05:10+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/04/26/Unity之使用IOS 3DTouch功能/" class="leancloud_visitors" data-flag-title="Unity之使用IOS 3DTouch功能">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>Unity工程在IOS平台使用3DTouch功能，提供了以下接口：<br>（1）Input.touchPressureSupported：是否支持3Dtouch，bool类型<br>（2）Touch.pressure：获取当前按压值，float类型<br>（3）Touch.maximumPossiblePressure：获取最大按压值，float类型</p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/04/26/Unity之DOTweenPath轨迹移动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/26/Unity之DOTweenPath轨迹移动/" class="post-title-link" itemprop="url">Unity之DOTweenPath轨迹移动</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-26 16:29:19" itemprop="dateCreated datePublished" datetime="2017-04-26T16:29:19+08:00">2017-04-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:22" itemprop="dateModified" datetime="2019-03-11T22:05:22+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/04/26/Unity之DOTweenPath轨迹移动/" class="leancloud_visitors" data-flag-title="Unity之DOTweenPath轨迹移动">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>先简单介绍一下DOTweenPath。</p>
<p>先来看一下DOTweenPath组件的截图</p>
<p><img src="https://img-blog.csdn.net/20170426150708706?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>1、Scene View Commands<br>（1）SHIFT+CTRL：add a waypoint<br>加一个轨迹点<br>（2）SHIFT+ALT：remove a waypoint<br>移除一个轨迹点</p>
<p>2、INfo<br>（1）Path Length：轨迹长度</p>
<p>3、Tween Options<br>（1）AutoPlay：自动播放<br>（2）AutoKill：播放完自动销毁动画<br>（3）Duration：动画时长<br>SpeedBased：If selected ,the duration will count as units/degreex<br>second;如果被选上，该时间作为单位时间。</p>
<p>（4）Delay：延时<br>（5）Ease：这是一个枚举，可以理解为动画播放速率曲线<br><img src="https://img-blog.csdn.net/20170426152601405?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>相关网址：<br><a href="http://dotween.demigiant.com/documentation.php" target="_blank" rel="noopener"> http://dotween.demigiant.com/documentation.php</a><br>以及： <a href="http://robertpenner.com/easing/easing_demo.html" target="_blank" rel="noopener"> http://robertpenner.com/easing/easing_demo.html</a></p>
<p>（6）Loops：循环次数，动画循环播放的次数<br>-1：表示 一直循环<br>0：表示只播放一次<br>当该值&gt;1时，检视面板出现LoopType，顾名思义就是指循环类型：<br>Restart：重新开始，后面的动画循环播放会从起点重新开始；<br>Yoyo：来回播放<br>Incremental：增加的，后面的path移动动画会在上一次循环的终点的基础上进行播放</p>
<p>（7）ID：动画ID<br>（8）UpdateType：这个枚举有三个值，指更新类型<br>Normal：正常更新，Update()<br>Late：晚于更新，LateUpdate()<br>Fixed：固定更新，FixedUpdate()</p>
<p>4、Path Tween Options<br>（1）Path Type：轨迹线类型<br>Linear：线型的<br>Catmull Rom：曲线<br>（2）Close Path：封闭曲线，将起点和终点相连<br>（3）Lock Rotation：锁旋转，xyzw</p>
<p>5、Path Editor Options：轨迹编辑参数，就不介绍了</p>
<p>6、ResetPath：重置轨迹<br>7、Events：<br>（1）OnStart：开始时<br>（2）OnPlay：播放时<br>（3）OnUpdate：更新时<br>（4）OnStep：单步完成时<br>（5）OnComplete：完成时<br>（6）OnCreated：动画创建时<br>事件顺序为：OnCreated-&gt;OnStart-&gt;OnPlay-&gt;OnUpdate（一直执行，直到完成），动画过程中单步完成时执行OnStep，整个动画完成后执行OnComplete</p>
<p>8、WayPoints：移动轨迹点<br>其中右边的Copy to clipboard，将坐标复制至剪贴板<br><img src="https://img-blog.csdn.net/20170426160635797?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>加减按钮即指增加减少坐标点</p>
<p>以上便是对于DOTweenPath组件的一个基本介绍。</p>
<p>接下来，DOTween对于轨迹移动提供的接口：<br>（1）DOPath：<br><img src="https://img-blog.csdn.net/20170426162319897?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>（2）DOLocalPath<br><img src="https://img-blog.csdn.net/20170426162640305?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>以上两个函数的参数再上面已经介绍过，这里就不再重复说明了。</p>
<p>DOTween插件，大家请自行下载。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jingfengji.github.io/2017/04/25/Unity之MessageBox/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Ding">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JingFengJi">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/25/Unity之MessageBox/" class="post-title-link" itemprop="url">Unity之MessageBox</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-25 11:37:38" itemprop="dateCreated datePublished" datetime="2017-04-25T11:37:38+08:00">2017-04-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 22:05:25" itemprop="dateModified" datetime="2019-03-11T22:05:25+08:00">2019-03-11</time>
              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2017/04/25/Unity之MessageBox/" class="leancloud_visitors" data-flag-title="Unity之MessageBox">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <meta name="referrer" content="no-referrer">

<p>先上示意图：<br><img src="https://img-blog.csdn.net/20170425112628114?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjY5OTk1MDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>从图中可以看出，这是标准的MessageBox样式。我采用的是UGUI，中间是文字内容，下面包括确定取消两个按钮，右上角一个关闭按钮。</p>
<p>那么模仿MFC呢，我写了一个枚举如下：</p>
<pre><code>public enum MessageType
{
    Confirm,            //确定
    Cancel,             //取消
    ConfirmCancel,      //确定取消
    Yes,                //是
    No,                 //否
    YesNO,              //是否
}
</code></pre><p>从上可以看出，这是在定义按钮的样式，举例：Confirm指仅包括确定按钮。</p>
<p>接下来，直接上挂在该UI上的脚本代码：</p>
<pre><code>using System;
using UnityEngine;
using UnityEngine.EventSystems;
using UnityEngine.UI;


public class MessageBoxDialog : MonoBehaviour
{
    public GameObject CancelButton = null;          //取消按钮
    public GameObject ConfirmButton = null;         //确定按钮
    public GameObject CloseButton = null;           //关闭按钮
    public Text MessageText = null;                 //提示文字

    public Text ConfirmText = null;                 //确定文字
    public Text CancelText = null;                  //取消文字

    public Action OnCloseEvent = null;
    public Action OnConfirmEvent = null;
    // Use this for initialization
    void Start()
    {
        AddListener();
    }

    // Update is called once per frame
    void Update()
    {

    }

    private void AddListener()
    {
        if (CancelButton != null)
        {
            EventTriggerListener.Get(CancelButton).onClick = OnCancelButtonClicked;
        }
        if (ConfirmButton != null)
        {
            EventTriggerListener.Get(ConfirmButton).onClick = OnConfirmButtonClicked;
        }
    }

    private void OnConfirmButtonClicked(GameObject go, BaseEventData eventData)
    {
        if (OnConfirmEvent != null)
        {
            OnConfirmEvent();
        }
        else
        {
            OnCloseButtonClicked(null, null);
        }

    }

    private void OnCancelButtonClicked(GameObject go, BaseEventData eventData)
    {
        if (OnCloseEvent != null)
        {
            OnCloseEvent();
        }
        else
        {
            OnCloseButtonClicked(null, null);
        }
    }

    private void OnCloseButtonClicked(GameObject go, BaseEventData eventData)
    {
        GameObject.DestroyImmediate(gameObject);
    }

    public void UpdateButton(MessageType type)
    {
        switch (type)
        {
            case MessageType.ConfirmCancel:
                break;
            case MessageType.Cancel:
                ConfirmButton.SetActive(false);
                break;
            case MessageType.Confirm:
                CancelButton.SetActive(false);
                break;
            case MessageType.No:
                ConfirmButton.SetActive(false);
                CancelText.text = &quot;否&quot;;
                break;
            case MessageType.Yes:
                CancelButton.SetActive(false);
                ConfirmText.text = &quot;是&quot;;
                break;
            case MessageType.YesNO:
                ConfirmText.text = &quot;是&quot;;
                CancelText.text = &quot;否&quot;;
                break;
        }
    }
}
</code></pre><p>接下来是该篇文章的重点代码了，</p>
<pre><code>using System;
using UnityEngine;


public class MessageBox
{
    private static GameObject _messageBoxPrefab = null;
    private static GameObject _messageBox = null;

    private static string _messageBoxPrefabPath = &quot;UI/MessageBox&quot;;

    public static void Show(string info, MessageType type = MessageType.ConfirmCancel, Action cancelCallback = null,
        Action confirmCallback = null)
    {
        if (_messageBoxPrefab == null)
        {
            _messageBoxPrefab = Resources.Load(_messageBoxPrefabPath) as GameObject;
        }
        _messageBox = GameObject.Instantiate(_messageBoxPrefab) as GameObject;
        MessageBoxDialog msgbox = _messageBox.GetComponent&lt;MessageBoxDialog&gt;();
        msgbox.UpdateButton(type);
        msgbox.OnConfirmEvent += confirmCallback;
        msgbox.OnCloseEvent += cancelCallback;
        msgbox.MessageText.text = info;

        //以下是在自己的场景管理的基础上写的，既然这里还没讲到我的场景管理，就暂时用比较low的方法了
        //GameObject uiRoot = ScenesManager.Instance.CurScene.UiRoot.gameObject;
        //_messageBox.transform.SetParent(uiRoot.transform, false);

        GameObject canvas = GameObject.Find(&quot;Canvas&quot;);
        if(canvas != null)
        {
            _messageBox.transform.SetParent(canvas.transform, false);
        }
    }
}
</code></pre><p>该段代码中，大家应该注意到三点：<br>1、MessageBox的预制件路径，修改为自己的路径；<br>2、加载该预制件的方法，我用的是Resources.Load，这里并没有将我的资源管理介绍出来，所以就用的这个；<br>3、实例化该UI，给该UI赋父物体的时候，用的是比较low的方法，注释已经解释了。</p>
<p>接下来，就直接上工程了，大家 如有疑问，请留言。<br>链接： <a href="http://pan.baidu.com/s/1kVibxQJ" target="_blank" rel="noopener"> http://pan.baidu.com/s/1kVibxQJ </a><br>密码：45ql</p>
<p>以上知识分享，如有错误，欢迎指出，共同学习，共同进步。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Mr.Ding</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">59</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Ding</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/bootstrap.js?v=7.0.1"></script>


  
  



  




  
  
  <script>
    
    function showTime(Counter) {
      var entries = [];
      var $visitors = $('.leancloud_visitors');

      $visitors.each(function() {
        entries.push( $(this).attr('id').trim() );
      });

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url: { '$in': entries } }) })
        .done(function({ results }) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.url;
            var time = item.time;
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for (var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if (countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'NNhaQgimB4QlP2E7VIp881se-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'NNhaQgimB4QlP2E7VIp881se-gzGzoHsz',
                'X-LC-Key': 'r32VGyBHt0lquCi8EGcIJlJN',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            if ($('.post-title-link').length >= 1) {
              showTime(Counter);
            }
          
        });
    });
  </script>



  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
